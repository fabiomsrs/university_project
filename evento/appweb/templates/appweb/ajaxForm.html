{% extends './base.html' %}
{%load bootstrap%}

{%block content%}
		{%block js%}
			<script language="javascript">		
			$(document).ready(function(){					    	
				    	eventos = {{ form.eventos | safe}};
				        atividades_por_evento = {{form.atividades_por_evento | safe}};				       	
			        	evento = $("#id_evento option:selected").text();
						$("#id_atividade").empty();
						for (let [e, eatividades] of Object.entries(atividades_por_evento)){								
							if(e == evento){																			
								for(atividade in eatividades){									
												$("#id_atividade")
													.append($("<option></option>")
					                                .attr("value", eatividades[atividade])
	                	                			.text(eatividades[atividade]));					
								}							
							}
						}


						
			       		$("#id_evento").empty();							
						$.each(eventos, function(v){
							$("#id_evento").append($("<option></option>")
								.attr("value", eventos[v])
								.text(eventos[v]));
						});
				       	
		       	});			       	    	
				$(document).ready(function(){	
				    $("#id_evento").change(function(){populateAtividade()});});			       	    	
				    	eventos = {{ form.eventos | safe}};
				        atividades_por_evento = {{form.atividades_por_evento | safe}};				       	
				       	populateEventos();
						$("#id_atividade").empty();						

						function populateEventos(){				       		
				       		$("#id_evento").empty();							
							$.each(eventos, function(v){
								$("#id_evento").append($("<option></option>")
									.attr("value", eventos[v])
									.text(eventos[v]));
							});
				       	}		

				       	function populateAtividade(){								       		
							evento = $("#id_evento option:selected").text();
							$("#id_atividade").empty();
							for (let [e, eatividades] of Object.entries(atividades_por_evento)){								
								if(e == evento){																			
									for(atividade in eatividades){									
													$("#id_atividade")
														.append($("<option></option>")
						                                .attr("value", eatividades[atividade])
		                	                			.text(eatividades[atividade]));					
									}							
								}
							}
				       	}
				       									
			</script>
		{%endblock%}
		<form method="POST">{% csrf_token %}
			<div class="col-sm-10">
	        <div id='evento'>
	        	{{form|bootstrap}}
        	</div>         	
	        <button type="submit" name="go" class="btn btn-lg btn-primary btn-block">Sign up</button>
	        </div>	            
       </form>
{% endblock %}